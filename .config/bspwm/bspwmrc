#! /usr/bin/bash
#           ___
#      __ _|_  )_ _ ___ ___   personal page: https://a2n-s.github.io/
#     / _` |/ /| ' \___(_-<   github   page: https://github.com/a2n-s
#     \__,_/___|_||_|  /__/   my   dotfiles: https://github.com/a2n-s/dotfiles
#               __  _        __  _
#        __    / / | |__    / / | |__ ____ ____ __ ___ __  _ _ __
#      _/ _|  / /  | '_ \  / /  | '_ (_-< '_ \ V  V / '  \| '_/ _|
#     (_)__| /_/   |_.__/ /_/   |_.__/__/ .__/\_/\_/|_|_|_|_| \__|
#                                       |_|
# Description:  my config for bspwm.
# Dependencies: sxhkd, polybar
# License:      https://github.com/a2n-s/dotfiles/blob/main/LICENSE 
# Contributors: Stevan Antoine
#
#               Table of Content:
#                 monitor connection.
#                 configuration.
#                 coloring.
#                 rules.

# some handy variables.
AUTOSTART="$HOME/.config/bspwm/scripts/autostart.sh"
export WM_STARTUP_SOUND="$HOME/.local/share/sounds/startup.mp3"
export WM_CONKY_HELP="$HOME/.config/conky/bspwm.conkyrc"
export WM_CONKY_CLOCK="$HOME/.config/conky/vision/Z333-vision.conkyrc"
export WM_POLYBAR="$HOME/.config/polybar/launch.sh"
export WM_POLYBAR_THEME="forest"
export WM_LOCKER="$HOME/.local/bin/slock.sh"
# comment any of the following lines to change the behaviour of the startup of bspwm.
# export WM_USE_POLYBAR="yes"
# export WM_USE_SYSTRAY="yes"
export WM_PLAY_STARTUP_SOUND="yes"
export WM_NOTIFY_AT_STARTUP="yes"


# the top padding needs to adapt depending on whether a bar is used.
if [ -n "$WM_USE_POLYBAR" ]; then
    top_padding=20
else
    killall polybar
    top_padding=0
fi

# >>> monitor connection.
bspc monitor eDP-1  -n 1 -d I II III IV V
bspc monitor HDMI-2 -n 2 -d VI VII VIII IX X

# >>> configuration.
bspc config border_radius                 8
bspc config border_width                  2
bspc config window_gap                    2
bspc config top_padding                   $top_padding
bspc config bottom_padding                0
bspc config left_padding                  0
bspc config right_padding                 0
bspc config single_monocle                false
bspc config click_to_focus                true
bspc config split_ratio                   0.618
bspc config borderless_monocle            false
bspc config gapless_monocle               true
bspc config focus_by_distance             true
bspc config focus_follows_pointer         false
bspc config history_aware_focus           true
bspc config remove_disabled_monitors      true
bspc config merge_overlapping_monitors    true
bspc config pointer_modifier mod4
bspc config pointer_action1 move
bspc config pointer_action2 resize_side
bspc config pointer_action3 resize_corner

# >>> coloring.
colors="$HOME/.Xresources"
normal_border="color0"
active_border="color2"
focused_border="color1"
presel_feedback="color9"
urgent_border="color5"

bspc config normal_border_color   "$(grep "^*$normal_border:" "$colors" | sed 's/.*\s\+//')"
bspc config active_border_color   "$(grep "^*$active_border:" "$colors" | sed 's/.*\s\+//')"
bspc config focused_border_color  "$(grep "^*$focused_border:" "$colors" | sed 's/.*\s\+//')"
bspc config presel_feedback_color "$(grep "^*$presel_feedback:" "$colors" | sed 's/.*\s\+//')"
bspc config urgent_border_color   "$(grep "^*$urgent_border:" "$colors" | sed 's/.*\s\+//')"

# >>> rules.
bspc rule -a Emacs state=tiled focus=on follow=on manage=on
for app in "discord" "Caprine" "Slack" "Signal" "Thunderbird" "Gmail Desktop"; do
    bspc rule -a "$app" desktop='^5' state=tiled focus=off follow=off manage=on
done

# >>> autostart.
bash "$AUTOSTART"
